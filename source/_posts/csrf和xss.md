---
title: csrf、xss、中间人攻击
tags: 网络安全
categories: 网络安全
---

### csrf(跨站请求伪造)

- 是什么
  攻击者 诱导 用户在已经登录的网站上 通过点击广告链接等形式，让用户在不知情的情况下向服务器发起请求，造成用户出现损失的结果，比如说不知情的情况下发贴，甚至是转账

用户点击恶意链接后，浏览器以为是用户在操作，会将cookie一起发送给服务器，如果服务器只简单校验cookie会以为是正常请求造成问题

- 怎么预防

- cookie不能被获取

  - 设置samesite为strict，只有同一个网站发起的请求才可以访问
  - 通过请求头中的referer/origin, 服务端只处理来自同一个网站的内容，这样就能避免从其他网站中发起的请求

- 请求头中带上token，token在每次会话中不变，但是不同会话中的会改变的，目的是为了不让攻击者随意猜到拿到

### xss（跨脚本攻击）

- 是什么
  利用网页服务器没有对用户输入的数据进行过滤或者转义处理，导致用户输入攻击脚本对网站起到破坏或者盗取用户个人信息的结果
- 类型

  - 反射型
    只输入的内容只反射到浏览器，造成页面破坏。这种攻击方式往往需要攻击者诱使用户点击一个恶意链接，或者提交一个表单，或者进入一个恶意网址时，注入脚本进入被攻击网站，比如，点击了一个图片链接，而网站刚好就是通过执行图片链接的脚本进行页面显示这种情况。

  - 存储型
    用户输入的脚本发送到服务器被存储起来，用户再次查看时，这些脚本被执行，造成页面被破坏，或者发送了请求到第三方服务器，造成用户个人信息被盗取的结果

- 怎么预防

  - 对用户输入的数据进行转义或者过滤处理
  - 充分利用csp(内容安全策略)
    - 限制加载其他域名下的资源文件，这样即使黑客插入一个js文件，这个js也是无法被加载
    - 禁止向第三方域提交数据，这样用户数据也不会外泄
    - 禁止执行内联脚本和未授权脚本
  - 使用httpOnly属性
    由于很多xss攻击都是用来盗用cookie的，因此还可以通过使用httpOnly属性来保护我们的cookie的安全

- 对数据进行转义或者过滤处理

### 中间人攻击

  第三方拦截了web服务器和客户端（浏览器）之间的流量，并冒充web服务器以捕获数据（例如用户登录凭证）；流量传入会导致这种问题，常见的就是
  滥用不明来源的wifi
  https中不允许加载http的iframe链接，浏览器会报mixed content错误，因为这样会出现中间人攻击或者数据被篡改；因为http的明文传输，
  这样会出现数据被窃取，同时cookie在https和http中共享也会出现数据被窃取的情

### 内容安全策略（Content-Security-Policy) CSP

- 是什么
  通过指定哪些资源可以加载到网页中来减少跨脚本攻击（XSS）等内容安全策略。CSP可以有效的指定可以执行的有效资源，以及限制内联脚本和内联样式
  等安全政策，帮助防止恶意脚本注入和其他类型的攻击，并报告攻击

- 如何设置
<meta
  http-equiv="Content-Security-Policy"
  content="default-src 'self; img-src <https://>*; child-src 'none';"
/>
